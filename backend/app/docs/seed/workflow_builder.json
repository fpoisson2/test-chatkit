[
  {
    "slug": "workflow-builder",
    "title": "Guide du Workflow Builder",
    "summary": "Présentation du concepteur de workflows ChatKit et de ses fonctionnalités clés.",
    "language": "fr",
    "content_markdown": "# Workflow Builder\n\nLe Workflow Builder de ChatKit permet de créer des expériences conversationnelles en orchestrant des agents et des actions.\n\n## Démarrer un nouveau workflow\n\n1. Créez ou importez un workflow depuis la bibliothèque.\n2. Ajoutez des blocs (agents, actions, états) depuis la barre latérale.\n3. Connectez les blocs pour définir le parcours utilisateur.\n\n## Astuces\n\n- Utilisez des noms explicites pour les nœuds afin de faciliter la collaboration.\n- Prévisualisez régulièrement votre workflow pour vérifier les transitions.\n- Définissez des résumés clairs afin d'améliorer la recherche dans la base documentaire.",
    "category": "guides",
    "tags": [
      "workflow",
      "builder",
      "guides"
    ]
  },
  {
    "slug": "hosted-workflows",
    "title": "Configurer un workflow hébergé",
    "summary": "Pas à pas pour relier ChatKit à un workflow publié dans la console OpenAI.",
    "language": "fr",
    "content_markdown": "# Configurer un workflow hébergé ChatKit\n\nCe guide explique comment connecter une instance auto-hébergée de ChatKit à un workflow publié dans la console OpenAI. Il complète les traces visibles dans les logs du backend (`POST /api/chatkit`, requêtes sortantes vers `api.openai.com`) et décrit les réglages nécessaires pour obtenir un workflow hébergé opérationnel.\n\n## 1. Pré-requis côté OpenAI\n\n1. Publiez un workflow depuis la console ChatKit et notez son **identifiant** (champ `id`).\n2. Créez une clé API disposant de l'accès ChatKit.\n3. Facultatif : vérifiez l'environnement réseau. Depuis le serveur ChatKit auto-hébergé, un simple `curl https://api.openai.com/v1/models` doit retourner `200`.\n\n## 2. Configurer l'accès API\n\nDans votre fichier `.env` (ou via `docker compose`), définissez les variables nécessaires pour appeler l'API OpenAI :\n\n```bash\nMODEL_PROVIDER=openai\nMODEL_API_BASE=https://api.openai.com\nOPENAI_API_KEY=\"sk-...\"\n```\n\nPoints d'attention :\n\n- `MODEL_PROVIDER` et `MODEL_API_BASE` doivent correspondre au point d'accès OpenAI utilisé pour ChatKit.\n- `OPENAI_API_KEY` (ou la variable définie par `MODEL_API_KEY_ENV`) doit porter les permissions ChatKit.\n- Si vous passez par un proxy, ajustez `MODEL_API_BASE` en conséquence.\n- Optionnel : `CHATKIT_WORKFLOW_ID` reste pris en charge pour les déploiements existants. Lorsqu'elle est définie, elle est simplement ajoutée à la liste des workflows disponibles mais n'est plus obligatoire.\n\nRedémarrez ensuite le backend :\n\n```bash\ndocker compose up -d backend\n```\n\nSur un démarrage réussi, les logs doivent indiquer la création du serveur ChatKit puis les appels sortants vers `https://api.openai.com` lors des requêtes `/api/chatkit`.\n\n## 3. Déclarer le workflow hébergé dans l'interface\n\nDans le Workflow Builder, ouvrez l'onglet **Workflows hébergés**, puis cliquez sur **Ajouter** :\n\n1. Saisissez un **slug** (ex : `assistant-voix`).\n2. Renseignez l'identifiant du workflow OpenAI (`wf_...`).\n3. Optionnel : ajoutez un libellé et une description pour aider les agents à le reconnaître.\n\nUne fois l'entrée enregistrée, elle apparaît dans la liste et le frontend peut l'utiliser. Vous pouvez également référencer ce slug dans l'étape **Start** du workflow pour un accès direct depuis l'UI.\n\nPar défaut, le backend utilisera le premier workflow géré (ou celui déclaré dans l'étape **Start**) lorsque le frontend demande une session sans slug spécifique. Plus besoin de variable d'environnement : l'enregistrement dans l'interface suffit.\n\n## 4. Forcer l'usage du workflow hébergé côté frontend\n\nLe frontend peut se connecter automatiquement au workflow distant. Pour forcer ce mode (utile en développement sans workflow local) :\n\n```bash\nVITE_CHATKIT_FORCE_HOSTED=true npm run frontend:dev\n```\n\nLe widget sélectionnera alors automatiquement le premier workflow hébergé disponible (ou celui dont le slug est demandé via l'UI). En cas d'erreur (`hosted_workflow_not_configured` ou `hosted_workflow_not_found`), l'interface affichera le message correspondant et désactivera le mode hébergé.\n\n## 5. Vérification des logs\n\nLorsqu'une session hébergée est ouverte, vous verrez des lignes similaires dans les logs du backend :\n\n```\nINFO  backend - \"POST /api/chatkit\" 200 OK\nDEBUG httpcore.connection:connect_tcp.started host='api.openai.com'\n```\n\nCes traces confirment que ChatKit relaie la requête vers l'API OpenAI. En cas d'échec, cherchez `ChatKit session creation failed` dans les logs : la réponse distante y est détaillée.\n\n## 6. Aller plus loin\n\n- Utilisez l'onglet **Workflows hébergés** du Workflow Builder pour exposer plusieurs workflows distants et permettre aux agents d'y accéder.\n- Combinez les workflows hébergés avec la téléphonie (`TELEPHONY_DEFAULT_WORKFLOW_SLUG`) pour répondre aux appels entrants directement via la version publiée.\n\nAvec cette configuration, votre instance ChatKit agit comme une passerelle sécurisée vers vos workflows hébergés OpenAI tout en conservant la supervision locale des utilisateurs et des journaux.\n",
    "category": "guides",
    "tags": [
      "workflow",
      "hosted",
      "chatkit"
    ]
  }
]
